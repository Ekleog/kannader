<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Used by hosts to limit resource consumption of instances."><meta name="keywords" content="rust, rustlang, rust-lang, ResourceLimiter"><title>ResourceLimiter in wiggle::wasmtime_crate - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../wiggle/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../wiggle/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">ResourceLimiter</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.memory_growing">memory_growing</a></li><li><a href="#tymethod.table_growing">table_growing</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#provided-methods">Provided Methods</a></h3><ul><li><a href="#method.instances">instances</a></li><li><a href="#method.memories">memories</a></li><li><a href="#method.memory_grow_failed">memory_grow_failed</a></li><li><a href="#method.table_grow_failed">table_grow_failed</a></li><li><a href="#method.tables">tables</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In wiggle::wasmtime_crate</a></h2><div id="sidebar-vars" data-name="ResourceLimiter" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../wiggle/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Trait <a href="../index.html">wiggle</a>::<wbr><a href="index.html">wasmtime_crate</a>::<wbr><a class="trait" href="#">ResourceLimiter</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/wasmtime/limits.rs.html#30-121">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust trait"><code>pub trait ResourceLimiter {
    fn <a href="#tymethod.memory_growing" class="fnname">memory_growing</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desired: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.table_growing" class="fnname">table_growing</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desired: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>;

    fn <a href="#method.memory_grow_failed" class="fnname">memory_grow_failed</a>(&amp;mut self, _error: &amp;<a class="struct" href="../../anyhow/struct.Error.html" title="struct anyhow::Error">Error</a>) { ... }
<div class="item-spacer"></div>    fn <a href="#method.table_grow_failed" class="fnname">table_grow_failed</a>(&amp;mut self, _error: &amp;<a class="struct" href="../../anyhow/struct.Error.html" title="struct anyhow::Error">Error</a>) { ... }
<div class="item-spacer"></div>    fn <a href="#method.instances" class="fnname">instances</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
<div class="item-spacer"></div>    fn <a href="#method.tables" class="fnname">tables</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
<div class="item-spacer"></div>    fn <a href="#method.memories" class="fnname">memories</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Used by hosts to limit resource consumption of instances.</p>
<p>This trait is used in conjunction with the
<a href="struct.Store.html#method.limiter"><code>Store::limiter</code></a> to synchronously limit the
allocation of resources within a store. As a store-level limit this means
that all creation of instances, memories, and tables are limited within the
store. Resources limited via this trait are primarily related to memory and
limiting CPU resources needs to be done with something such as
<a href="struct.Config.html#method.consume_fuel"><code>Config::consume_fuel</code></a> or
<a href="struct.Config.html#method.epoch_interruption"><code>Config::epoch_interruption</code></a>.</p>
<p>Note that this trait does not limit 100% of memory allocated via a
<a href="struct.Store.html"><code>Store</code></a>. Wasmtime will still allocate memory to track data
structures and additionally embedder-specific memory allocations are not
tracked via this trait. This trait only limits resources allocated by a
WebAssembly instance itself.</p>
<p>This trait is intended for synchronously limiting the resources of a module.
If your use case requires blocking to answer whether a request is permitted
or not and you’re otherwise working in an asynchronous context the
<a href="trait.ResourceLimiterAsync.html" title="ResourceLimiterAsync"><code>ResourceLimiterAsync</code></a> trait is also provided to avoid blocking an OS
thread while a limit is determined.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.memory_growing" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#58">source</a></div><h4 class="code-header">fn <a href="#tymethod.memory_growing" class="fnname">memory_growing</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;current: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;desired: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;maximum: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;<br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></h4></div></summary><div class="docblock"><p>Notifies the resource limiter that an instance’s linear memory has been
requested to grow.</p>
<ul>
<li><code>current</code> is the current size of the linear memory in bytes.</li>
<li><code>desired</code> is the desired size of the linear memory in bytes.</li>
<li><code>maximum</code> is either the linear memory’s maximum or a maximum from an
instance allocator, also in bytes. A value of <code>None</code>
indicates that the linear memory is unbounded.</li>
</ul>
<p>The <code>current</code> and <code>desired</code> amounts are guaranteed to always be
multiples of the WebAssembly page size, 64KiB.</p>
<p>This function should return <code>true</code> to indicate that the growing
operation is permitted or <code>false</code> if not permitted. Returning <code>true</code>
when a maximum has been exceeded will have no effect as the linear
memory will not grow.</p>
<p>This function is not guaranteed to be invoked for all requests to
<code>memory.grow</code>. Requests where the allocation requested size doesn’t fit
in <code>usize</code> or exceeds the memory’s listed maximum size may not invoke
this method.</p>
<p>Returning <code>false</code> from this method will cause the <code>memory.grow</code>
instruction in a module to return -1 (failure), or in the case of an
embedder API calling <a href="struct.Memory.html#method.new"><code>Memory::new</code></a> or
<a href="struct.Memory.html#method.grow"><code>Memory::grow</code></a> an error will be returned from
those methods.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.table_growing" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#86">source</a></div><h4 class="code-header">fn <a href="#tymethod.table_growing" class="fnname">table_growing</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;current: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;desired: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;maximum: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;<br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></h4></div></summary><div class="docblock"><p>Notifies the resource limiter that an instance’s table has been
requested to grow.</p>
<ul>
<li><code>current</code> is the current number of elements in the table.</li>
<li><code>desired</code> is the desired number of elements in the table.</li>
<li><code>maximum</code> is either the table’s maximum or a maximum from an instance
allocator.  A value of <code>None</code> indicates that the table is unbounded.</li>
</ul>
<p>This function should return <code>true</code> to indicate that the growing
operation is permitted or <code>false</code> if not permitted. Returning <code>true</code>
when a maximum has been exceeded will have no effect as the table will
not grow.</p>
<p>Currently in Wasmtime each table element requires a pointer’s worth of
space (e.g. <code>mem::size_of::&lt;usize&gt;()</code>).</p>
<p>Like <code>memory_growing</code> returning <code>false</code> from this function will cause
<code>table.grow</code> to return -1 or embedder APIs will return an error.</p>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="method.memory_grow_failed" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#66">source</a></div><h4 class="code-header">fn <a href="#method.memory_grow_failed" class="fnname">memory_grow_failed</a>(&amp;mut self, _error: &amp;<a class="struct" href="../../anyhow/struct.Error.html" title="struct anyhow::Error">Error</a>)</h4></div></summary><div class="docblock"><p>Notifies the resource limiter that growing a linear memory, permitted by
the <code>memory_growing</code> method, has failed.</p>
<p>Reasons for failure include: the growth exceeds the <code>maximum</code> passed to
<code>memory_growing</code>, or the operating system failed to allocate additional
memory. In that case, <code>error</code> might be downcastable to a <code>std::io::Error</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.table_grow_failed" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#93">source</a></div><h4 class="code-header">fn <a href="#method.table_grow_failed" class="fnname">table_grow_failed</a>(&amp;mut self, _error: &amp;<a class="struct" href="../../anyhow/struct.Error.html" title="struct anyhow::Error">Error</a>)</h4></div></summary><div class="docblock"><p>Notifies the resource limiter that growing a linear memory, permitted by
the <code>table_growing</code> method, has failed.</p>
<p>Reasons for failure include: the growth exceeds the <code>maximum</code> passed to
<code>table_growing</code>. This could expand in the future.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.instances" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#100">source</a></div><h4 class="code-header">fn <a href="#method.instances" class="fnname">instances</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></h4></div></summary><div class="docblock"><p>The maximum number of instances that can be created for a <code>Store</code>.</p>
<p>Module instantiation will fail if this limit is exceeded.</p>
<p>This value defaults to 10,000.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.tables" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#109">source</a></div><h4 class="code-header">fn <a href="#method.tables" class="fnname">tables</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></h4></div></summary><div class="docblock"><p>The maximum number of tables that can be created for a <code>Store</code>.</p>
<p>Creation of tables will fail if this limit is exceeded.</p>
<p>This value defaults to 10,000.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.memories" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#118">source</a></div><h4 class="code-header">fn <a href="#method.memories" class="fnname">memories</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></h4></div></summary><div class="docblock"><p>The maximum number of linear memories that can be created for a <code>Store</code></p>
<p>Creation of memories will fail with an error if this limit is exceeded.</p>
<p>This value defaults to 10,000.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><section id="impl-ResourceLimiter" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../../src/wasmtime/limits.rs.html#272-298">source</a></span><a href="#impl-ResourceLimiter" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.ResourceLimiter.html" title="trait wiggle::wasmtime_crate::ResourceLimiter">ResourceLimiter</a> for <a class="struct" href="struct.StoreLimits.html" title="struct wiggle::wasmtime_crate::StoreLimits">StoreLimits</a></h3></section></div><script type="text/javascript" src="../../implementors/wasmtime/limits/trait.ResourceLimiter.js" async></script></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="wiggle" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0-nightly (285fa7ecd 2022-03-14)" ></div>
</body></html>